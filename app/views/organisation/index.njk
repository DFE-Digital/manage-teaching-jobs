
{% extends "layout.njk" %}

{% if user.organisation.schools %}
  {% set title = 'Organisation profile' %}
{% else %}
  {% set title = 'School profile' %}
{% endif %}

{% set primaryNavId = 'organisation' %}

{% block content %}

  {% if showCompleteProfileBanner %}
    {% if user.organisation.schools %}
      {{ govukNotificationBanner({
        text: "Complete your organisation profile"
      }) }}
    {% else %}
      {{ govukNotificationBanner({
        text: "Complete your school profile"
      }) }}
    {% endif %}
  {% endif %}


  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">

      <h1 class="govuk-heading-l">
        {{title}}
      </h1>

      {% if user.organisation.schools %}
        <p><a href="/organisation/preview">Preview organisation profile</a></p>

        {% set address %}
          {% for part, value in user.organisation.address %}
            {{value}}{% if not loop.last %}, {% endif %}
          {% endfor %}
        {% endset %}

        {% set website %}
          <a href="{{user.organisation.website}}">{{user.organisation.website}} (opens in new tab)</a>
        {% endset %}

        {% set about %}
          {% if user.organisation.about %}
            {{user.organisation.logo | nl2br}}
          {% else %}
            <div class="app-field-highlight">
              <p class="app-field-highlight__instruction">Enter information about your organisation</p>
              Not entered
            </div>
          {% endif %}
        {% endset %}

        {% set howEmployeesAreSupported %}
          {% if user.organisation.supportForEmployees %}
            {{user.organisation.supportForEmployees | escape | nl2br}}
          {% else %}
            <div class="app-field-highlight">
              <p class="app-field-highlight__instruction">Enter information about what your organisation offers its employees</p>
              Not entered
            </div>
          {% endif %}
        {% endset %}

        {% set safeguardingCommitment %}
          {% if user.organisation.safeguardingCommitment %}
            {{user.organisation.safeguardingCommitment | escape | nl2br}}
          {% else %}
            <div class="app-field-highlight">
              <p class="app-field-highlight__instruction">Enter information about your commitment to safeguarding</p>
              Not entered
            </div>
          {% endif %}
        {% endset %}

        {% set logo %}
          {% if user.organisation.logo %}
            <img src="{{user.organisation.logo}}" alt="Logo" width="150">
          {% else %}
            <div class="app-field-highlight">
              <p class="app-field-highlight__instruction">Add organisation logo</p>
              Not entered
            </div>
          {% endif %}
        {% endset %}

        {% set photo %}
          {% if user.organisation.photo %}
            <img src="{{user.organisation.photo}}" alt="Photo" width="100%">
          {% else %}
            <div class="app-field-highlight">
              <p class="app-field-highlight__instruction">Add organisation photo</p>
              Not entered
            </div>
          {% endif %}
        {% endset %}


        {{ govukSummaryList({
          rows: [
            {
              key: {
                text: "Name"
              },
              value: {
                text: user.organisation.name
              }
            },
            {
              key: {
                text: "Type"
              },
              value: {
                text: 'Multi-academy trust'
              }
            },
            {
              key: {
                text: "Address"
              },
              value: {
                text: address
              }
            },
            {
              key: {
                text: "Website"
              },
              value: {
                html: website
              },
              actions: {
                items: [
                  {
                    href: "Item URL",
                    text: "Change",
                    visuallyHiddenText: "Item label"
                  }
                ]
              }
            },
            {
              key: {
                text: "About the organisation"
              },
              value: {
                html: about
              },
              actions: {
                items: [
                  {
                    href: "/organisation/edit/description",
                    text: "Change",
                    visuallyHiddenText: "About the organisation"
                  }
                ]
              }
            },
            {
              key: {
                text: "What the organisation offers its employees"
              },
              value: {
                html: howEmployeesAreSupported
              },
              actions: {
                items: [
                  {
                    href: "/organisation/edit/description",
                    text: "Change",
                    visuallyHiddenText: "About school"
                  }
                ]
              }
            },
            {
              key: {
                text: "Your commitment to safeguarding"
              },
              value: {
                html: safeguardingCommitment
              },
              actions: {
                items: [
                  {
                    href: "/organisation/edit/safeguarding-commitment",
                    text: "Change",
                    visuallyHiddenText: "Safeguarding commitment"
                  }
                ]
              }
            },
            {
                key: {
                  text: "Organisation logo"
                },
                value: {
                  html: logo
                },
                actions: {
                  items: [
                    {
                      href: "/organisation/edit-logo",
                      text: "Change",
                      visuallyHiddenText: "About school"
                    }
                  ]
                }
              },
              {
                key: {
                  text: "Organisation photo"
                },
                value: {
                  html: photo
                },
                actions: {
                  items: [
                    {
                      href: "/organisation/edit/photo",
                      text: "Change",
                      visuallyHiddenText: "About school"
                    }
                  ]
                }
              }
          ]
        }) }}

          <h2 class="govuk-heading-m govuk-!-margin-top-8">
            Schools
          </h2>

          {% for school in schools %}
            <div class="app-school govuk-!-margin-bottom-0 {% if loop.first %}govuk-!-padding-top-0{% endif %}">

              {% if school.missingInformation.length %}
                 <div class="app-field-highlight {% if loop.first %}govuk-!-margin-top-2{% endif %}">
                  <h3 class="govuk-heading-s govuk-!-margin-bottom-2">
                    <a href="/schools/{{school.id}}">{{school.name}}</a>
                  </h3>
                  <p class="app-field-highlight__instruction">Complete your school profile</p>
                </div>
              {% else %}
                <h3 class="govuk-heading-s govuk-!-margin-bottom-0">
                  <a href="/schools/{{school.id}}">{{school.name}}</a>
                </h3>
              {% endif %}
            </div>
          {% endfor %}
      {% else %}
        <p><a href="/organisation/preview">Preview school profile</a></p>
        {{appSchoolSummaryList({ school: user.organisation })}}
      {% endif %}









    </div>
  </div>

{% endblock %}
